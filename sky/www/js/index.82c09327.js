import{_ as lt,m as ct,I as ut,z as ft,a as dt,b as pt,c as _t,r as yt,d as mt}from"../index.js";/* empty css              */import{c as vt,l as gt,T as ht,d as bt,a as xt,r as wt}from"./index.fed51933.js";/* empty css               *//* empty css              *//* empty css               *//* empty css              */import{c as St,r as D,f as kt,J as $,aO as G,aP as u,N as M,l,aZ as R,K as H,u as J,F as Tt,b3 as Et,b4 as X,a_ as I,aT as nt,b5 as Ct,b6 as zt,b7 as At,b8 as Pt,aY as at,b9 as Ot,ba as Nt,bb as It,bc as rt,bd as Lt,a$ as Mt,b0 as $t,p as Rt,aX as Dt,be as jt,an as Bt,bf as Ft,bg as Vt}from"./arco.73db23e5.js";import{u as it}from"./loading.a8216e84.js";import"./vue.57427092.js";import"./vendor.7cd83524.js";var Kt={exports:{}};/*!
 * clipboard.js v2.0.11
 * https://clipboardjs.com/
 *
 * Licensed MIT Â© Zeno Rocha
 */(function(w,V){(function(C,z){w.exports=z()})(St,function(){return function(){var L={686:function(d,a,t){t.d(a,{default:function(){return st}});var o=t(279),p=t.n(o),f=t(370),b=t.n(f),g=t(817),S=t.n(g);function v(c){try{return document.execCommand(c)}catch{return!1}}var y=function(n){var e=S()(n);return v("cut"),e},i=y;function k(c){var n=document.documentElement.getAttribute("dir")==="rtl",e=document.createElement("textarea");e.style.fontSize="12pt",e.style.border="0",e.style.padding="0",e.style.margin="0",e.style.position="absolute",e.style[n?"right":"left"]="-9999px";var r=window.pageYOffset||document.documentElement.scrollTop;return e.style.top="".concat(r,"px"),e.setAttribute("readonly",""),e.value=c,e}var K=function(n,e){var r=k(n);e.container.appendChild(r);var s=S()(r);return v("copy"),r.remove(),s},F=function(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body},r="";return typeof n=="string"?r=K(n,e):n instanceof HTMLInputElement&&!["text","search","url","tel","password"].includes(n==null?void 0:n.type)?r=K(n.value,e):(r=S()(n),v("copy")),r},j=F;function P(c){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?P=function(e){return typeof e}:P=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},P(c)}var Y=function(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=n.action,r=e===void 0?"copy":e,s=n.container,_=n.target,N=n.text;if(r!=="copy"&&r!=="cut")throw new Error('Invalid "action" value, use either "copy" or "cut"');if(_!==void 0)if(_&&P(_)==="object"&&_.nodeType===1){if(r==="copy"&&_.hasAttribute("disabled"))throw new Error('Invalid "target" attribute. Please use "readonly" instead of "disabled" attribute');if(r==="cut"&&(_.hasAttribute("readonly")||_.hasAttribute("disabled")))throw new Error(`Invalid "target" attribute. You can't cut text from elements with "readonly" or "disabled" attributes`)}else throw new Error('Invalid "target" value, use a valid Element');if(N)return j(N,{container:s});if(_)return r==="cut"?i(_):j(_,{container:s})},h=Y;function x(c){return typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?x=function(e){return typeof e}:x=function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},x(c)}function A(c,n){if(!(c instanceof n))throw new TypeError("Cannot call a class as a function")}function O(c,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(c,r.key,r)}}function T(c,n,e){return n&&O(c.prototype,n),e&&O(c,e),c}function E(c,n){if(typeof n!="function"&&n!==null)throw new TypeError("Super expression must either be null or a function");c.prototype=Object.create(n&&n.prototype,{constructor:{value:c,writable:!0,configurable:!0}}),n&&B(c,n)}function B(c,n){return B=Object.setPrototypeOf||function(r,s){return r.__proto__=s,r},B(c,n)}function Q(c){var n=et();return function(){var r=U(c),s;if(n){var _=U(this).constructor;s=Reflect.construct(r,arguments,_)}else s=r.apply(this,arguments);return W(this,s)}}function W(c,n){return n&&(x(n)==="object"||typeof n=="function")?n:tt(c)}function tt(c){if(c===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return c}function et(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch{return!1}}function U(c){return U=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},U(c)}function m(c,n){var e="data-clipboard-".concat(c);if(!!n.hasAttribute(e))return n.getAttribute(e)}var Z=function(c){E(e,c);var n=Q(e);function e(r,s){var _;return A(this,e),_=n.call(this),_.resolveOptions(s),_.listenClick(r),_}return T(e,[{key:"resolveOptions",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this.action=typeof s.action=="function"?s.action:this.defaultAction,this.target=typeof s.target=="function"?s.target:this.defaultTarget,this.text=typeof s.text=="function"?s.text:this.defaultText,this.container=x(s.container)==="object"?s.container:document.body}},{key:"listenClick",value:function(s){var _=this;this.listener=b()(s,"click",function(N){return _.onClick(N)})}},{key:"onClick",value:function(s){var _=s.delegateTarget||s.currentTarget,N=this.action(_)||"copy",q=h({action:N,container:this.container,target:this.target(_),text:this.text(_)});this.emit(q?"success":"error",{action:N,text:q,trigger:_,clearSelection:function(){_&&_.focus(),window.getSelection().removeAllRanges()}})}},{key:"defaultAction",value:function(s){return m("action",s)}},{key:"defaultTarget",value:function(s){var _=m("target",s);if(_)return document.querySelector(_)}},{key:"defaultText",value:function(s){return m("text",s)}},{key:"destroy",value:function(){this.listener.destroy()}}],[{key:"copy",value:function(s){var _=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{container:document.body};return j(s,_)}},{key:"cut",value:function(s){return i(s)}},{key:"isSupported",value:function(){var s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:["copy","cut"],_=typeof s=="string"?[s]:s,N=!!document.queryCommandSupported;return _.forEach(function(q){N=N&&!!document.queryCommandSupported(q)}),N}}]),e}(p()),st=Z},828:function(d){var a=9;if(typeof Element<"u"&&!Element.prototype.matches){var t=Element.prototype;t.matches=t.matchesSelector||t.mozMatchesSelector||t.msMatchesSelector||t.oMatchesSelector||t.webkitMatchesSelector}function o(p,f){for(;p&&p.nodeType!==a;){if(typeof p.matches=="function"&&p.matches(f))return p;p=p.parentNode}}d.exports=o},438:function(d,a,t){var o=t(828);function p(g,S,v,y,i){var k=b.apply(this,arguments);return g.addEventListener(v,k,i),{destroy:function(){g.removeEventListener(v,k,i)}}}function f(g,S,v,y,i){return typeof g.addEventListener=="function"?p.apply(null,arguments):typeof v=="function"?p.bind(null,document).apply(null,arguments):(typeof g=="string"&&(g=document.querySelectorAll(g)),Array.prototype.map.call(g,function(k){return p(k,S,v,y,i)}))}function b(g,S,v,y){return function(i){i.delegateTarget=o(i.target,S),i.delegateTarget&&y.call(g,i)}}d.exports=f},879:function(d,a){a.node=function(t){return t!==void 0&&t instanceof HTMLElement&&t.nodeType===1},a.nodeList=function(t){var o=Object.prototype.toString.call(t);return t!==void 0&&(o==="[object NodeList]"||o==="[object HTMLCollection]")&&"length"in t&&(t.length===0||a.node(t[0]))},a.string=function(t){return typeof t=="string"||t instanceof String},a.fn=function(t){var o=Object.prototype.toString.call(t);return o==="[object Function]"}},370:function(d,a,t){var o=t(879),p=t(438);function f(v,y,i){if(!v&&!y&&!i)throw new Error("Missing required arguments");if(!o.string(y))throw new TypeError("Second argument must be a String");if(!o.fn(i))throw new TypeError("Third argument must be a Function");if(o.node(v))return b(v,y,i);if(o.nodeList(v))return g(v,y,i);if(o.string(v))return S(v,y,i);throw new TypeError("First argument must be a String, HTMLElement, HTMLCollection, or NodeList")}function b(v,y,i){return v.addEventListener(y,i),{destroy:function(){v.removeEventListener(y,i)}}}function g(v,y,i){return Array.prototype.forEach.call(v,function(k){k.addEventListener(y,i)}),{destroy:function(){Array.prototype.forEach.call(v,function(k){k.removeEventListener(y,i)})}}}function S(v,y,i){return p(document.body,v,y,i)}d.exports=f},817:function(d){function a(t){var o;if(t.nodeName==="SELECT")t.focus(),o=t.value;else if(t.nodeName==="INPUT"||t.nodeName==="TEXTAREA"){var p=t.hasAttribute("readonly");p||t.setAttribute("readonly",""),t.select(),t.setSelectionRange(0,t.value.length),p||t.removeAttribute("readonly"),o=t.value}else{t.hasAttribute("contenteditable")&&t.focus();var f=window.getSelection(),b=document.createRange();b.selectNodeContents(t),f.removeAllRanges(),f.addRange(b),o=f.toString()}return o}d.exports=a},279:function(d){function a(){}a.prototype={on:function(t,o,p){var f=this.e||(this.e={});return(f[t]||(f[t]=[])).push({fn:o,ctx:p}),this},once:function(t,o,p){var f=this;function b(){f.off(t,b),o.apply(p,arguments)}return b._=o,this.on(t,b,p)},emit:function(t){var o=[].slice.call(arguments,1),p=((this.e||(this.e={}))[t]||[]).slice(),f=0,b=p.length;for(f;f<b;f++)p[f].fn.apply(p[f].ctx,o);return this},off:function(t,o){var p=this.e||(this.e={}),f=p[t],b=[];if(f&&o)for(var g=0,S=f.length;g<S;g++)f[g].fn!==o&&f[g].fn._!==o&&b.push(f[g]);return b.length?p[t]=b:delete p[t],this}},d.exports=a,d.exports.TinyEmitter=a}},C={};function z(d){if(C[d])return C[d].exports;var a=C[d]={exports:{}};return L[d](a,a.exports,z),a.exports}return function(){z.n=function(d){var a=d&&d.__esModule?function(){return d.default}:function(){return d};return z.d(a,{a}),a}}(),function(){z.d=function(d,a){for(var t in a)z.o(a,t)&&!z.o(d,t)&&Object.defineProperty(d,t,{enumerable:!0,get:a[t]})}}(),function(){z.o=function(d,a){return Object.prototype.hasOwnProperty.call(d,a)}}(),z(686)}().default})})(Kt);const Ut=w=>{if(isNaN(w))return"0 bytes";const V=["bytes","KB","MB","GB","TB","PB","EB","ZB","YB"];let L=Math.floor(Math.log(w)/Math.log(2));L<1&&(L=0);const C=Math.floor(L/10);return w/=2**(10*C),w.toString().length>w.toFixed(2).toString().length&&(w=w.toFixed(2)),`${w} ${V[C]}`};const ot=w=>(Mt("data-v-6fb09d77"),w=w(),$t(),w),Ht={class:"frame-bg"},Yt={class:"frame-body"},Zt={class:"frame-aside"},qt={class:"frame-main"},Gt={key:0,class:"main-content"},Jt=ot(()=>M("span",{style:{"font-size":"15px"}},"\u4EE3\u7406\u534F\u8BAE",-1)),Xt=ot(()=>M("span",{style:{"font-size":"15px"}},"\u901A\u9053\u540D\u79F0",-1)),Qt={key:1,class:"main-content"},Wt=ot(()=>M("span",null,"\u8FD0\u884C\u4EE5\u4E0B\u547D\u4EE4\u5F00\u59CB\u4F7F\u7528\u8BE5\u7AEF\u53E3",-1)),te={style:{display:"flex",alignItems:"center",justifyContent:"space-between"}},ee={style:{display:"flex",alignItems:"center",color:"#1D2129"}},ne={__name:"port-form",emits:["ok"],setup(w,{expose:V,emit:L}){const{loading:C,setLoading:z}=it(),d=D(!1),a=D({zone_id:"",zone_name:"",protocol:"trojan"}),t=L,o=D(1),p=kt(()=>o.value==1?"\u4E0B\u4E00\u6B65":"\u5B8C\u6210"),f=D({port:null,ip:null,protocol:null}),b=D([]),g=async()=>{try{z(!0);const{data:y}=await ft();b.value=y.map(i=>({zone_id:i.zone_id,zone_name:i.zone_name}))}catch{}finally{z(!1)}},S=async()=>{if(o.value==1){if(!a.value.zone_id)return nt.error("\u8BF7\u9009\u62E9\u901A\u9053"),!0;try{const{data:y}=await vt({zone_id:a.value.zone_id,protocol:a.value.protocol,proxy_users:[]});f.value=y;const{data:i}=await ct();f.value.ip=i.ip,o.value=2}catch{}}else a.value={zone_id:null,zone_name:null,protocol:"trojan"},d.value=!1,t("ok");return!0};return V({open:async()=>{g(),o.value=1,a.value={zone_id:null,zone_name:null,protocol:"trojan"},d.value=!0}}),(y,i)=>{const k=Ct,K=zt,F=At,j=Pt,P=at,Y=Ot,h=ut,x=Nt,A=It,O=rt,T=Lt;return $(),G(T,{visible:d.value,title:"\u521B\u5EFA\u7AEF\u53E3","unmount-on-close":"","mask-closable":!1,width:"550px","ok-text":p.value,"ok-loading":J(C),"hide-cancel":"","on-before-ok":S,onCancel:i[2]||(i[2]=E=>d.value=!1)},{default:u(()=>[M("div",Ht,[M("div",Yt,[M("div",Zt,[l(K,{current:o.value,direction:"vertical"},{default:u(()=>[l(k,null,{default:u(()=>[R("\u9009\u62E9\u901A\u9053")]),_:1}),l(k,null,{default:u(()=>[R("\u5B8C\u6210\u521B\u5EFA")]),_:1})]),_:1},8,["current"])]),M("div",qt,[o.value===1?($(),H("div",Gt,[l(P,{direction:"vertical",fill:"",style:{"margin-bottom":"11px"}},{default:u(()=>[Jt,l(j,{modelValue:a.value.protocol,"onUpdate:modelValue":i[0]||(i[0]=E=>a.value.protocol=E),style:{width:"320px"},placeholder:"\u8BF7\u9009\u62E9\u4EE3\u7406\u534F\u8BAE"},{default:u(()=>[l(F,{label:"Skyproxy",value:"trojan"}),l(F,{label:"Socks5/HTTP(s)",value:"mixed"})]),_:1},8,["modelValue"])]),_:1}),l(P,{direction:"vertical",fill:""},{default:u(()=>[Xt,l(j,{modelValue:a.value.zone_id,"onUpdate:modelValue":i[1]||(i[1]=E=>a.value.zone_id=E),style:{width:"320px"},placeholder:"\u8BF7\u9009\u62E9\u901A\u9053",loading:J(C)},{default:u(()=>[($(!0),H(Tt,null,Et(b.value,(E,B)=>($(),G(F,{key:B,label:E.zone_name,value:E.zone_id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","loading"])]),_:1})])):X("",!0),o.value===2?($(),H("div",Qt,[l(P,{direction:"vertical",fill:""},{default:u(()=>[M("span",null,[R(" \u60A8\u5DF2\u7ECF\u521B\u5EFA\u4E86\u4E00\u4E2A\u65B0\u7AEF\u53E3 "),l(Y,{color:"green"},{default:u(()=>[R(I(f.value.port),1)]),_:1})]),l(O,{hoverable:"",style:{width:"340px"}},{default:u(()=>[l(P,{direction:"vertical",fill:""},{default:u(()=>[Wt,M("div",te,[M("span",ee,[l(x,{style:{marginRight:"8px",backgroundColor:"#165DFF"},size:25},{default:u(()=>[l(h)]),_:1}),l(A,{copyable:""},{default:u(()=>[R(I(f.value.protocol)+"://"+I(f.value.ip)+":"+I(f.value.port),1)]),_:1})])])]),_:1})]),_:1})]),_:1})])):X("",!0)])])])]),_:1},8,["visible","ok-text","ok-loading"])}}},oe=lt(ne,[["__scopeId","data-v-6fb09d77"]]);const ae={style:{padding:"22px"}},re={key:0},ie={key:1},he={__name:"index",setup(w,{expose:V}){const{loading:L,setLoading:C}=it(),{pageSize:z}=mt(),d=D(null),a=D({pageSize:z,total:0,current:1,showTotal:!0,showJumper:!0,showPageSize:!0,pageSizeOptions:[15,30,50,100,200]}),t=h=>h?` / ${h}`:"",o=D([]),p=Rt({type:"checkbox",showCheckedAll:!0,onlyCurrent:!0}),f=[{title:"#",dataIndex:"id",slotName:"id",align:"center",ellipsis:!0,tooltip:!0,width:10},{title:"\u5185\u90E8\u540D\u79F0",dataIndex:"internal_name",slotName:"internal_name",align:"center",ellipsis:!0,tooltip:!0},{title:"\u4EE3\u7406\u7AEF\u53E3",dataIndex:"port",slotName:"port",align:"center",ellipsis:!0,tooltip:!0},{title:"\u72B6\u6001",dataIndex:"status",slotName:"status",align:"center",ellipsis:!0,tooltip:!0},{title:"\u901A\u9053\u540D",dataIndex:"zone_name",slotName:"zone_name",align:"center",ellipsis:!0,tooltip:!0},{title:"\u5B9A\u4F4D",dataIndex:"position",slotName:"position",align:"center",ellipsis:!0,tooltip:!0},{title:"\u8BF7\u6C42",dataIndex:"request",slotName:"request",align:"center",ellipsis:!0,tooltip:!0},{title:"\u6D41\u91CF",dataIndex:"flow",slotName:"flow",align:"center",ellipsis:!0,tooltip:!0},{title:"\u64CD\u4F5C",align:"center",slotName:"oper",width:220}],b=D([]),g=async(h=null)=>{try{C(!0);const{data:x}=await gt({page:h,limit:a.value.pageSize}),{list:A,total:O}=x,T=[];A.forEach(E=>{E.multiply>0?T.push({...E,isLeaf:!1}):T.push({...E,isLeaf:!0})}),b.value=T,a.value.current=h,a.value.total=O}catch{}finally{C(!1)}};g(1);const S=h=>{g(h)},v=h=>{a.value.pageSize=h,g(1)},y=()=>{b.value=[],g(1)},i=()=>{d.value.open()},k=async h=>{try{C(!0),await bt({ids:h}),nt.success("\u5220\u9664\u6210\u529F"),y()}catch{}finally{C(!1)}},K=async()=>{o.value.length>0&&(await k([...o.value]),o.value=[])},F=async(h,x)=>{const{data:A}=await xt({pid:h.id}),O=[];A.forEach(T=>{O.push({...T,isLeaf:!0})}),x(O)},j=h=>{yt.push({name:"PortSetting",query:{id:h}})},P=async h=>{try{h.status="Testing";const{data:x}=await wt({id:h.id});nt.success("\u5237\u65B0\u6210\u529F"),h.status=x.status}catch{h.status="Fail"}},Y=async()=>{o.value.length>0&&b.value.forEach(async h=>{o.value.includes(h.id)&&P(h)})};return V({getTableData:g}),(h,x)=>{const A=Dt,O=dt,T=jt,E=Bt,B=Ft,Q=at,W=pt,tt=_t,et=Vt,U=rt;return $(),H("div",ae,[l(U,null,{default:u(()=>[l(ht,{style:{"margin-bottom":"16px"}},{right:u(()=>[l(T,{content:"\u5237\u65B0\u5217\u8868"},{default:u(()=>[l(A,{type:"outline",shape:"circle",onClick:y},{default:u(()=>[l(W)]),_:1})]),_:1})]),default:u(()=>[l(Q,null,{default:u(()=>[l(A,{type:"primary",shape:"round",onClick:i},{default:u(()=>[R(" \u521B\u5EFA\u7AEF\u53E3 ")]),_:1}),l(T,{content:"\u5237\u65B0\u7AEF\u53E3"},{default:u(()=>[l(A,{type:"text",onClick:Y},{default:u(()=>[l(O,{size:20})]),_:1})]),_:1}),l(T,{content:"\u5220\u9664\u7AEF\u53E3"},{default:u(()=>[l(B,{content:"\u786E\u5B9A\u5220\u9664\u8FD9\u4E9B\u7AEF\u53E3?",position:"bottom",onOk:K},{default:u(()=>[l(A,{type:"text"},{default:u(()=>[l(E,{size:20})]),_:1})]),_:1})]),_:1})]),_:1})]),_:1}),l(et,{selectedKeys:o.value,"onUpdate:selectedKeys":x[0]||(x[0]=m=>o.value=m),loading:J(L),columns:f,data:b.value,"row-key":"id","row-selection":p,pagination:a.value,stripe:!0,"load-more":F,onPageChange:S,onPageSizeChange:v},{flow:u(({record:m})=>[R(I(J(Ut)(m.flow)),1)]),internal_name:u(({record:m})=>[R(I(m.internal_name?m.internal_name:"--"),1)]),status:u(({record:m})=>[R(I(m.status?m.status:"--"),1)]),position:u(({record:m})=>[R(I(!m.area&&!m.state&&!m.city?"\u4EFB\u610F":m.area+t(m.state)+t(m.city)),1)]),port:u(({record:m})=>[m.multiply>0?($(),H("span",re,I(m.port)+" ["+I(m.multiply)+"]",1)):($(),H("span",ie,I(m.port),1))]),oper:u(({record:m})=>[l(T,{content:"\u5220\u9664\u7AEF\u53E3"},{default:u(()=>[l(B,{content:"\u786E\u5B9A\u5220\u9664\u8BE5\u7AEF\u53E3?",onOk:Z=>k([m.id])},{default:u(()=>[m.pid==0?($(),G(A,{key:0,type:"text"},{default:u(()=>[l(E)]),_:1})):X("",!0)]),_:2},1032,["onOk"])]),_:2},1024),l(T,{content:"\u5237\u65B0\u7AEF\u53E3"},{default:u(()=>[l(A,{type:"text",onClick:Z=>P(m)},{default:u(()=>[l(O)]),_:2},1032,["onClick"])]),_:2},1024),l(T,{content:"\u7AEF\u53E3\u8BBE\u7F6E"},{default:u(()=>[m.pid==0?($(),G(A,{key:0,type:"text",onClick:Z=>j(m.id)},{default:u(()=>[l(tt)]),_:2},1032,["onClick"])):X("",!0)]),_:2},1024)]),_:1},8,["selectedKeys","loading","data","row-selection","pagination"])]),_:1}),l(oe,{ref_key:"formRef",ref:d,onOk:y},null,512)])}}};export{he as default};
